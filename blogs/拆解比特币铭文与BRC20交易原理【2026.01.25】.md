## é“­æ–‡ Inscription

### é“­æ–‡åŸºæœ¬ä»‹ç»

é“­æ–‡å°±æ˜¯æŠŠä»»æ„æ•°æ®ï¼ˆå¦‚å›¾ç‰‡ã€JSONã€æ–‡æœ¬ã€JSï¼‰æ°¸ä¹…åœ°å†™è¿›æ¯”ç‰¹å¸åŒºå—é“¾çš„ä¸€ä¸ªèªï¼ˆSatoshiï¼‰ä¸Šã€‚

1 BTC = 1 äº¿ä¸ª Satoshiã€‚Ordinals åè®®é€šè¿‡ç»™æ¯ä¸€ä¸ª Satoshi è¿›è¡Œå”¯ä¸€çš„ç¼–å·ï¼ˆä» 0 åˆ° 2.1 å…†ï¼‰ï¼Œèµ‹äºˆäº†è¿™äº›æœ€å°å•ä½â€œä¸ªä½“èº«ä»½â€ã€‚è€Œé“­æ–‡ï¼Œå°±æ˜¯ç»™è¿™ä¸ªç‰¹å®šçš„å•ä½æŒ‚è½½ä¸€æ®µâ€œåªè¯»æ•°æ®â€ã€‚

åœ¨ 2021 å¹´ä¹‹å‰ï¼Œæ¯”ç‰¹å¸çš„é™åˆ¶åœ¨äºï¼š

- è„šæœ¬èƒ½åŠ›å¼± - éå›¾çµå®Œå¤‡ï¼Œæ²¡æœ‰å¾ªç¯å’ŒçŠ¶æ€ï¼Œåªåšç®€å•éªŒè¯ã€‚
- å¤æ‚è„šæœ¬éšç§å·®æ‰‹ç»­è´¹é«˜ - å¤šç­¾å’Œæ¡ä»¶è„šæœ¬éƒ½å¿…é¡»å…¬å¼€æ‰€æœ‰åˆ†æ”¯å’ŒéªŒè¯è·¯å¾„

é“­æ–‡åœ¨ 2023 å¹´çš„å®ç°ï¼Œå…³é”®åœ¨äº 2021 å¹´çš„ **Taproot å‡çº§**ã€‚

Taproot å‡çº§ä¹‹åæ”¹å˜äº†ä»€ä¹ˆï¼š

- æ›´å¥½çš„éšç§
  - æŠŠ Script çš„æ‰§è¡Œï¼Œä»â€œå…¨éƒ¨å…¬å¼€â€ï¼Œå˜æˆäº†â€œæŒ‰éœ€å…¬å¼€â€ã€‚
  - ä¸€ä¸ª Taproot Output æœ‰ä¸¤ç§èŠ±è´¹æ–¹å¼ï¼š
    - **Key Path**ï¼ˆåƒæ™®é€šå•ç­¾ï¼‰
    - **Script Path**ï¼ˆåªæš´éœ²ä½ èµ°çš„é‚£æ¡è„šæœ¬ï¼‰
  - Script è¢«åŒ…åœ¨ä¸€æ£µ Merkle Tree é‡Œï¼Œåªéœ€è¦ reveal ç”¨åˆ°çš„è„šæœ¬å’Œå¯¹åº”çš„ Merkle proof
- **ä¸è®¡å…¥ UTXO å¤§å°**
  - é“­æ–‡æ•°æ®å­˜å‚¨åœ¨äº¤æ˜“çš„ **Witnessï¼ˆè§è¯æ•°æ®ï¼‰** åŒºï¼Œè¿›å…¥åŒºå—æƒé‡ä½†ä¸è®¡å…¥ UTXOï¼Œä¸”æ‰‹ç»­è´¹æœ‰æŠ˜æ‰£ã€‚


Taproot ä¸Šçº¿ä¹‹åçš„ä¸€å¹´ä¸­éƒ½æ²¡æœ‰å‘ç”Ÿä»€ä¹ˆæ–°çš„å™äº‹ï¼Œè€Œæ˜¯å¼€å‘è€…åœ¨æ…¢æ…¢è¿›è¡ŒæŠ€æœ¯è¿ç§»ã€‚

ç›´åˆ° 2022 å¹´ 12 æœˆ 14 æ—¥ Rodarmor æå‡º Ordinals Protocolï¼Œç›¸å½“äºæ˜¯å¯¹ Taproot çš„ä¸€æ¬¡æ–°çš„è§£è¯»ã€‚

### Ordinals åè®®çš„å‡ºç°

> https://docs.ordinals.com/overview.html

Rodarmor ä¸€å¼€å§‹åšçš„äº‹æƒ…æ˜¯ ç»™ satoshiï¼ˆä¹Ÿå« satï¼Œæ˜¯æ¯”ç‰¹å¸åè®®ä¸­çš„æœ€å°å•ä½ï¼Œ1 BTC = 10^8 satoshiï¼‰ç¼–å·ï¼Œsatoshi Theory ç»™ä¸åŒçš„ sat æŒ‰ç…§æ¯”ç‰¹å¸å†å²å¼€å§‹æŒ–çŸ¿é¡ºåºæ˜¯è®¾ç½®ä¸€ä¸ªå”¯ä¸€ç¼–å·ã€‚è¿™å…¶å®æ›´å¤šçš„æ˜¯ä¸€ä¸ªé“¾ä¸‹è¡Œä¸ºï¼Œæ˜¯è‡ªå·±å®šä¹‰çš„ç®—æ³•å’Œç»´æŠ¤çš„ indexã€‚

åæ¥çš„æ”¹å˜æ˜¯ä»ç»™ sat è®¾ç½®ç¼–å·ï¼Œåˆ°ç»™ sat é™„ç€ä¸€æ®µä»£è¡¨äº†æŸäº›æ„ä¹‰çš„æ•°æ®ï¼Œäºæ˜¯é“­æ–‡è¯ç”Ÿäº†ï¼ŒInscription å°±è¡¨ç¤ºç»™æŸä¸€ä¸ª sat æŒ‡å®šä¸€æ®µåªè¯»æ•°æ®

```
OP_FALSE
OP_IF
  <ä»»æ„æ•°æ®>
OP_ENDIF
```

è¿™æ®µé€»è¾‘çš„å«ä¹‰æ˜¯ï¼š

- OP_FALSE â†’ æ¡ä»¶ä¸ºå‡
- OP_IF â†’ ä¸è¿›å…¥
- ä¸­é—´çš„æ•°æ® **ä¸ä¼šæ‰§è¡Œ** ä½† **ä¼šè¢«å®Œæ•´å­˜å‚¨å’Œä¼ æ’­**

å¯¹äºé“¾çš„å…±è¯†æ¥è¯´è¿™æ˜¯ä¸€ä¸ªåˆæ³•çš„è„šæœ¬ï¼Œè€Œå¯¹äº Ordinals åè®®æ¥è¯´è¿™æ˜¯é“­æ–‡ç»‘å®šæ•°æ®çš„æ–¹å¼ã€‚

ç¬¬ä¸€ä¸ªé“­æ–‡çš„è¯ç”Ÿ:

https://ordinals.com/inscription/626127511953479e1933a448f020c76acd9086efe2f2b3f5e492c0c85d2ce051i0

### æ‹†è§£ä¸€ç¬”é“­æ–‡çš„ Reveal Transaction

å…¶ä¸­ Reveal Transactionï¼Œä¹Ÿå°±æ˜¯æŠŠæ•°æ®å†™è¿› witness çš„äº¤æ˜“: https://mempool.space/zh/tx/626127511953479e1933a448f020c76acd9086efe2f2b3f5e492c0c85d2ce051

<img src="https://raw.githubusercontent.com/lxiiiixi/Image-Hosting/main/Markdown/20251223174614.png" />




```bash
curl https://api.blockcypher.com/v1/btc/main/txs/626127511953479e1933a448f020c76acd9086efe2f2b3f5e492c0c85d2ce051

# ç»“æœå¦‚ä¸‹ï¼š
{
  "block_hash": "00000000000000000002e9e1d5f989eb603124ba45e84bde98f9e9152867a564",
  "block_height": 823205,
  "block_index": 1721,
  "hash": "626127511953479e1933a448f020c76acd9086efe2f2b3f5e492c0c85d2ce051",
  "addresses": [
    "bc1pad8anzc2cegx9pzzeff0jmdsdl6fp7kfe3m22nvsxz278trw5lqq4dtcz3",
    "bc1pvkumrkmmr4jgp9u3xg6qjx52wupu5vcp0rh6zfpha2tlhslpf0eqt3c4m0"
  ],
  "total": 10000,
  "fees": 41160,
  "size": 303,
  "vsize": 147,
  "preference": "high",
  "confirmed": "2023-12-27T22:33:55Z",
  "received": "2023-12-27T22:33:55Z",
  "ver": 2,
  "double_spend": false,
  "vin_sz": 1,
  "vout_sz": 1,
  "opt_in_rbf": true,
  "confirmations": 105895,
  "confidence": 1,
  "inputs": [
    {
      "prev_hash": "d9cdd676e3ac0b7d3b4df69cbe29c7e5b2fbbb6acfd1ea234696939d1e70453b",
      "output_index": 0,
      "output_value": 51160,
      "sequence": 4294967293,
      "addresses": [
        "bc1pad8anzc2cegx9pzzeff0jmdsdl6fp7kfe3m22nvsxz278trw5lqq4dtcz3"
      ],
      "script_type": "pay-to-taproot",
      "age": 823205,
      "witness": [
        "650716f447596c03f197f90d3e6576351a0fb5fb9228740abd67e4e61b0bbb6e4053b6a635628058a2fe4515d76aff56787cbfbb6ab034bb4231c74dfe7b1aac",
        "201dcfcaa2c97b7f153b074b155479e3a5f1cf8b3a7d3bff153646e9dd94448c14ac0063036f7264010118746578742f706c61696e3b636861727365743d7574662d38010b209927442e695da8d0cef7abc2a7e14a20835939841e201e7f01ecdc49ab76b96f00013068",
        "c01dcfcaa2c97b7f153b074b155479e3a5f1cf8b3a7d3bff153646e9dd94448c14"
      ]
    }
  ],
  "outputs": [
    {
      "value": 10000,
      "script": "512065b9b1db7b1d648097913234091a8a7703ca330178efa12437ea97fbc3e14bf2",
      "spent_by": "88284e60136c0ae19c7915a94cefd6d18edb3e8a549324e26c4b856c5c7e34a9",
      "addresses": [
        "bc1pvkumrkmmr4jgp9u3xg6qjx52wupu5vcp0rh6zfpha2tlhslpf0eqt3c4m0"
      ],
      "script_type": "pay-to-taproot"
    }
  ]
}%    
```

é“­æ–‡çš„æ•°æ®æ˜¯å­˜å‚¨åœ¨é“¾ä¸Šçš„ï¼Œå…·ä½“æ¥è¯´æ˜¯å­˜å‚¨åœ¨ Taproot äº¤æ˜“çš„ witness ä¸­ã€‚ä¸Šé¢è¿™ä¸ªå°±æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Taprootï¼ˆP2TRï¼‰èŠ±è´¹äº¤æ˜“ï¼Œç”¨ Tapscript èŠ±è´¹ä¸€ä¸ª Taproot UTXOï¼Œåœ¨ witness é‡Œæ‰§è¡Œä¸€æ®µè„šæœ¬ï¼Œè¿™æ®µè„šæœ¬ä¸­åŒ…å«äº†ä¸€æ®µä¸ä¼šè¢«æ‰§è¡Œã€ä½†ä¼šè¢«å®Œæ•´ä¿å­˜çš„é“­æ–‡æ•°æ®ã€‚

ï¼ˆå¯¹äºé“­æ–‡çš„åœºæ™¯æ¥è¯´ï¼‰ä¸Šé¢çš„ witness ç»“æ„æ˜¯å›ºå®šçš„ï¼š

```
witness stack:
1. signature 
2. tapscript
3. control block
```

å…¶ä¸­ï¼š

- Witness[0] â€”â€” Schnorr ç­¾å
  - ç”¨æ¥è¯æ˜ä½ æœ‰æƒèŠ±è´¹è¿™ä¸ª UTXOï¼Œè·Ÿé“­æ–‡æ— å…³ï¼Œåªæ˜¯äº¤æ˜“åˆæ³•æ€§çš„å¿…è¦æ¡ä»¶ã€‚
  - é’ˆå¯¹ Taproot æœ¬èº«çš„è®¾è®¡ï¼Œæäº¤çš„ Witness å¯ä»¥åªæœ‰è¿™ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆèŠ‚ç‚¹çš„éªŒè¯æµç¨‹å°±æ˜¯
    - å– UTXO é‡Œçš„ Taproot å…¬é’¥
    - ç”¨ signature éªŒè¯
    - æˆåŠŸ â†’ èŠ±è´¹æˆç«‹
- Witness[1] â€”â€” Tapscriptï¼ˆæ ¸å¿ƒï¼‰
  - è¿™æ˜¯ä¸€æ•´æ®µ **Tapscript**ï¼Œé‡Œé¢åŒ…å«äº†é“­æ–‡æ•°æ®ï¼Œæœ¬è´¨ä¸Šæ˜¯é¡ºä¾¿åˆ©ç”¨äº†è¿™é‡Œçš„åŠŸèƒ½ï¼Œè¿™æ®µè„šæœ¬ä¼šæ‰§è¡Œï¼Œä½†é“­æ–‡æ•°æ®æ‰€åœ¨çš„ OP_FALSE OP_IF åˆ†æ”¯ä¸ä¼šæ‰§è¡Œï¼Œåªæ˜¯ä½œä¸ºä¸€ä¸ªå®¹å™¨æ‰¿è½½å†…å®¹ã€‚
  - è¿™æ®µ Tapscript å®šä¹‰äº†ä¸€æ¡å¯è¢«æ‰§è¡Œçš„èŠ±è´¹è§„åˆ™ã€‚
- Witness[2] â€”â€” Control Block
  - è¿™æ˜¯ Taproot Script Path çš„æ§åˆ¶å—ï¼Œå‘Šè¯‰éªŒè¯è€…è¿™æ®µ script å±äº Taproot æ‰¿è¯ºä¸­çš„å“ªä¸€æ¡åˆ†æ”¯ä»¥åŠå¦‚ä½•è¿˜åŸå‡º Taproot å…¬é’¥

å¯¹äºè¿™ä¸ªå®Œæ•´çš„ç»“æ„ï¼ˆä¹Ÿå°±æ˜¯ä¸€æ—¦æäº¤äº† script + control blockï¼ŒèŠ‚ç‚¹å°±é»˜è®¤çŸ¥é“æˆ‘é€‰æ‹©çš„æ˜¯ Script Path èŠ±è´¹ï¼‰ï¼ŒèŠ‚ç‚¹çš„éªŒè¯æµç¨‹æ˜¯ï¼š
1 - ç”¨ tapscript + control block è®¡ç®—å‡ºä¸€ä¸ª Taproot å…¬é’¥
2 - å’Œ UTXO é‡Œçš„ Taproot å…¬é’¥æ¯”è¾ƒ
3 - å¦‚æœç›¸ç­‰ â†’ ç»§ç»­
4 - æ‰§è¡Œ tapscript
5 - å¦‚æœæ‰§è¡Œç»“æœä¸º true â†’ èŠ±è´¹æˆç«‹

æ€»çš„æ¥è¯´ï¼Œè¿™ç¬”äº¤æ˜“ç”¨ Taproot çš„ Script Path èŠ±è´¹äº†æ—§çš„ UTXOï¼Œåœ¨èŠ±è´¹çš„è¿‡ç¨‹ä¸­æŠŠé“­æ–‡æ•°æ®æ”¾è¿›äº† witnessï¼Œå¹¶ä¸”æŠŠæºå¸¦è¯¥é“­æ–‡çš„ sat è½¬ç§»ç»™å¦ä¸€ä¸ª Taproot åœ°å€ã€‚

---

æ¥æ‹†è§£ä¸€ä¸‹ä¸Šé¢è¿™ä¸ª reveal äº¤æ˜“çš„ P2TR è„šæœ¬æ˜¯ä»€ä¹ˆæ„æ€

```
OP_PUSHBYTES_32 1dcfcaa2c97b7f153b074b155479e3a5f1cf8b3a7d3bff153646e9dd94448c14  
OP_CHECKSIG  
OP_0  
OP_IF  
OP_PUSHBYTES_3 6f7264  
OP_PUSHBYTES_1 01  
OP_PUSHBYTES_24 746578742f706c61696e3b636861727365743d7574662d38  
OP_PUSHBYTES_1 0b  
OP_PUSHBYTES_32 9927442e695da8d0cef7abc2a7e14a20835939841e201e7f01ecdc49ab76b96f  
OP_0  
OP_PUSHBYTES_1 30  
OP_ENDIF
```

- ğŸ”¹ OP_PUSHBYTES_32 <32å­—èŠ‚>
  - æŠŠä¸€ä¸ª **32 å­—èŠ‚çš„å…¬é’¥** å‹å…¥æ‰§è¡Œæ ˆ
- ğŸ”¹ OP_CHECKSIG
  - éªŒè¯ witness stack é‡Œæä¾›çš„ Schnorr ç­¾åï¼ˆä¾ç„¶æ˜¯èµ°ç­¾åéªŒè¯çš„é€»è¾‘ï¼‰ï¼Œæ˜¯å¦èƒ½ç”¨åˆšåˆšå‹æ ˆçš„å…¬é’¥éªŒè¯é€šè¿‡ã€‚
  - å¦‚æœç­¾åæ­£ç¡® â†’ æ ˆé¡¶å‹å…¥ `true`
  - å¦‚æœç­¾åé”™è¯¯ â†’ æ ˆé¡¶å‹å…¥ `false`
  - è¿™ä¸€æ­¥å…¶å®æœ¬è´¨ä¸Šå°±å®Œæˆäº†èŠ±è´¹éªŒè¯
- ğŸ”¹ OP_0
  - æŠŠä¸€ä¸ª `false` å‹å…¥æ ˆé¡¶
- ğŸ”¹ OP_IF
  - ä»æ ˆé¡¶å–ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå¦‚æœæ˜¯ `true` â†’ æ‰§è¡Œ IF å†…çš„ä»£ç ï¼Œå¦‚æœæ˜¯ `false` â†’ **è·³è¿‡ç›´åˆ° OP_ENDIF**ã€‚
  - åˆ°è¿™é‡Œä¹Ÿå°±æ˜¯è¯´ **OP_0 OP_IF = æ°¸è¿œä¸ä¼šè¿›å…¥çš„åˆ†æ”¯**ï¼Œå°±åœ¨è¿™é‡ŒæŠŠé“­æ–‡æ•°æ®ä¿å­˜èµ·æ¥ã€‚
- ğŸ”¹ IF å†…éƒ¨ç»“æ„
  - 6f7264 => 0x6f = o, 0x72 = r, 0x64 = d => å­—ç¬¦ä¸² `"ord"`
  - OP_PUSHBYTES_1 01 => ç‰ˆæœ¬å·
  - åç»­å°±çš„æ˜¯å…¶ä»–çš„ metadata

> #### æ‹†è§£ "ord" ä¸ 6f7264 çš„äº’ç›¸è½¬æ¢
>
> `6f7264 = "ord"` 
>
> 6f7264 æ˜¯å­—ç¬¦ä¸² ord æŒ‰ç…§ **ASCII / UTF-8** ç¼–ç æˆå­—èŠ‚ï¼Œå†ç”¨åå…­è¿›åˆ¶è¡¨ç¤ºè¿™äº›å­—èŠ‚ã€‚é»˜è®¤ä¸Šè¯´å®ƒæ˜¯ hex ç¼–ç çš„ bytesã€‚
>
> æ¯ 2 ä¸ª hex å­—ç¬¦ = 1 ä¸ªå­—èŠ‚ï¼ˆ8 bitï¼‰ã€‚
>
> ==Step1: æŠŠ `6f7264` å½“æˆã€Œå­—èŠ‚åºåˆ—ã€==
>
> `6f7264` => `6f 72 64`
>
> ==Step2: hex â†’ åè¿›åˆ¶ï¼ˆå­—èŠ‚çœŸå®å€¼ï¼‰==
>
> æŠŠæ¯ä¸ªå­—èŠ‚ä» **åå…­è¿›åˆ¶** è½¬æˆ **åè¿›åˆ¶**ï¼š
>
> ```
> 6f (hex)
> = 6 Ã— 16 + 15
> = 96 + 15
> = 111
> 
> 7 Ã— 16 + 2
> = 112 + 2
> = 114
> 
> 6 Ã— 16 + 4
> = 96 + 4
> = 100
> ```
>
> ==Step3: åè¿›åˆ¶ â†’ ASCII å­—ç¬¦==
>
> | åè¿›åˆ¶ | ASCII |
> | ------ | ----- |
> | 111    | o     |
> | 114    | r     |
> | 100    | d     |
>
> äºæ˜¯æ•´ä¸ªè¿‡ç¨‹å°±æ˜¯
>
> ```
> 6f 72 64
> â†“
> [111, 114, 100]
> â†“
> "o" "r" "d"
> â†“
> "ord"
> ```
>
> é‚£ä¹ˆ `"ord"` æ˜¯å¦‚ä½•å˜æˆ `6f7264` çš„ï¼Ÿ
>
> `"ord"`  â†’  æŒ‰ç…§ ASCII æ•°å€¼æ‰¾åˆ°åè¿›åˆ¶  â†’  ä»åè¿›åˆ¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶  â†’  æ‹¼æ¥å­—èŠ‚
>
> ```
> "ord"
> â†“ UTF-8 / ASCII
> [6f 72 64]
> â†“ hex è¡¨ç¤º
> 6f7264
> â†“ xxd -r -p
> åŸå§‹å­—èŠ‚
> â†“ è§£è¯»
> ord
> ```
>
> æ€»ç»“æ¥è¯´å°±æ˜¯ **â€œäººç±»å¯è¯»å­—ç¬¦ä¸²â€ â†’ UTF-8 / ASCII â†’ bytes â†’ hex è¡¨ç¤º**
>
> ```js
> Buffer.from("image/png", "utf8").toString("hex")
> // "696d6167652f706e67"
> 
> Buffer.from("696d6167652f706e67", "hex").toString("utf8")
> // "image/png"
> ```
>
> ä½¿ç”¨å‘½ä»¤è¡Œï¼š
>
> ```bash
> echo 696d6167652f706e67 | xxd -r -p
> # æŠŠä¸€ä¸²åå…­è¿›åˆ¶è¡¨ç¤ºçš„å­—èŠ‚è¿˜åŸæˆåŸå§‹å­—èŠ‚
> # å…¶ä¸­
> # -p = plain hex mode è¡¨ç¤ºè¾“å…¥ / è¾“å‡ºæ˜¯â€œçº¯åå…­è¿›åˆ¶å­—ç¬¦ä¸²â€ï¼Œæ²¡æœ‰åœ°å€ã€æ²¡æœ‰åç§»ã€æ²¡æœ‰æ ¼å¼åŒ–ã€‚
> # -r = reverse åå‘æ“ä½œï¼šä» hex â†’ è¿˜åŸæˆåŸå§‹å­—èŠ‚
> ```
>
> æŠŠå­—ç¬¦ä¸² 696d6167652f706e67 è¾“å‡º
> æŠŠå®ƒå½“ä½œâ€œçº¯ hexâ€
> æŒ‰æ¯ä¸¤ä¸ª hex å­—ç¬¦è¿˜åŸæˆ 1 ä¸ªå­—èŠ‚
> æŠŠè¿™äº›å­—èŠ‚ç›´æ¥è¾“å‡º

---

æ‹†è§£ `c01dcfcaa2c97b7f153b074b155479e3a5f1cf8b3a7d3bff153646e9dd94448c14` è¿™ä¸ª Control Block çš„æ ¼å¼

```
[1 byte]    control byte
[32 bytes]  internal public key
[N*32]      merkle pathï¼ˆå¯èƒ½ä¸º 0 ä¸ªï¼Œæ¯”å¦‚è¿™ä¸ªä¾‹å­å°±æ˜¯ï¼‰
```

1ï¸âƒ£ ç¬¬ 1 ä¸ªå­—èŠ‚ï¼š`c0`ï¼ˆc0 = 1100 0000 - äºŒè¿›åˆ¶ï¼‰

ç›¸å½“äºå‘èŠ‚ç‚¹å£°æ˜ä¸€ä¸ªåˆæ³•çš„ Taproot Script Path æ§åˆ¶å—

2ï¸âƒ£ æ¥ä¸‹æ¥çš„ 32 å­—èŠ‚1dcfcaa2c97b7f153b074b155479e3a5f1cf8b3a7d3bff153646e9dd94448c14 è¿™æ­£æ˜¯åœ¨ Tapscript é‡Œçœ‹åˆ°çš„é‚£ä¸ª 32 å­—èŠ‚å…¬é’¥

è¿™ä¸ªå…¬é’¥æ˜¯å½“åˆç”¨æ¥åˆ›å»ºè¿™ä¸ª P2TR UTXO æ—¶ç”Ÿæˆ output å…¬é’¥çš„åŸå§‹å…¬é’¥

é‚£ä¹ˆ tapscript å’Œ control block æ˜¯æ€ä¹ˆé…åˆçš„ï¼Ÿ

```
- tapscript            â† ä½ è¦æ‰§è¡Œçš„ç¨‹åº
- control block        â† å†…éƒ¨å…¬é’¥ + è¯æ˜ææ–™
```

èŠ‚ç‚¹æ¥ä¸‹æ¥ä¼šåˆ©ç”¨è¿™ä¸¤ä¸ªæ•°æ®åšä¸€ä¸ªè®¡ç®—ï¼Œ

ï¼ˆ1ï¼‰è®¡ç®— script hash - `script_hash = hash(tapscript)` å…ˆå¯¹ä½ ç»™çš„ tapscript åšå“ˆå¸Œ

ï¼ˆ2ï¼‰ä» control block å– internal_pubkey

ï¼ˆ3ï¼‰é‡æ–°è®¡ç®—ä¸€éå…¬é’¥ - `computed_pubkey = tweak(internal_pubkey, script_hash)`

ï¼ˆ4ï¼‰å’Œ UTXO ä¸­çš„å¯¹æ¯” - `if computed_pubkey == utxo.scriptPubKey.pubkey:` ä¸º true å°±è¯´æ˜è¿™æ®µ tapscript æ˜¯åˆæ³•æ¥æºã€‚

## BRC-20

### åŸºæœ¬ä»‹ç»

BRC20 æ˜¯æ¯”ç‰¹å¸ç½‘ç»œä¸Šå‘è¡Œ**åŒè´¨åŒ– Token**ï¼ˆå³æ¯ä¸ªå•ä½çš„ä»£å¸å‡æ‹¥æœ‰ç›¸åŒçš„åŠŸèƒ½å’Œå†…åœ¨ä»·å€¼ï¼‰çš„å®éªŒæ€§æ ¼å¼æ ‡å‡†ï¼Œç”± [@domodata](https://twitter.com/domodata) äº2023 å¹´3 æœˆ8 æ—¥åŸºäº [Ordinal åè®®](https://hc.foxwallet.com/zh/docs/bitcoin/ordinals) åˆ›å»ºã€‚ ç±»ä¼¼äºä»¥å¤ªåŠçš„ ERC20 æ ‡å‡†ï¼Œå®ƒè§„å®šäº†ä»¥å¤ªåŠä¸Šå‘è¡Œ Token çš„åç§°ã€å‘è¡Œé‡ã€è½¬è´¦ç­‰åŠŸèƒ½ã€‚

BRC-20 åˆ©ç”¨JSONæ ¼å¼çš„ Ordinals é“­æ–‡æ¥éƒ¨ç½²ä»£å¸åˆçº¦ã€é“¸é€ ä»£å¸å’Œè½¬è´¦ä»£å¸ï¼Œæ¯”ç‰¹å¸ç½‘ç»œä»…ä½œä¸ºæ•°æ®å±‚ï¼Œå…±è¯†ç”±å¤–éƒ¨çš„Indexeræ¥ä¿è¯ã€‚

```
{ 
  "p": "brc-20",
  "op": "deploy",
  "tick": "ordi",
  "max": "21000000",
  "lim": "1000"
}
```

é“­æ–‡å®ç°æ‰€å¸¦æ¥çš„ç°å®æ„ä¹‰æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨æ¯”ç‰¹å¸ä¸Šå†™ä¸œè¥¿äº†ï¼Œè€Œ BRC-20 åšçš„äº‹æƒ…æ˜¯ç»™é“­æ–‡æ•°æ®å¼ºè¡Œå®šä¹‰ä¸€å¥—â€œèµ„äº§è¯­ä¹‰â€

é“­æ–‡æ˜¯èƒ½åŠ›ï¼ŒBRC-20 æ˜¯â€œæŠŠèƒ½åŠ›è½¬è¯‘æˆé‡‘èå™äº‹çš„åè®®â€ã€‚å…¶å® ORDI ä»£å¸å’Œ Ordinal åè®®æœ¬èº«æ²¡æœ‰ä»»ä½•çš„å…³ç³»ï¼Œåªæ˜¯æœ‰äººåˆ©ç”¨äº†è¿™ä¸ªåè®®è¿ä½œçš„æ–¹å¼é™„åŠ ä¸Šäº†ä¸€å¥—èµ„äº§å™äº‹ã€‚

![image.png| 600](https://raw.githubusercontent.com/lxiiiixi/Image-Hosting/main/Markdown/20251224164524.png)

- Deploy
  -  å‘è¡Œé“­æ–‡
- Mint
  - æ‰“é“­æ–‡
- Transfer
  - äº¤æ˜“ï¼ˆé“­åˆ»ï¼‰
  - ä¹Ÿå°±æ˜¯æŠŠè¦è½¬å‡ºçš„æ•°é‡é”åˆ°ä¸€ä¸ªå…·ä½“çš„ UTXO ä¸­

æ¯”ç‰¹å¸ç½‘ç»œæœ¬è´¨ä¸Šæ²¡æœ‰å¤æ‚çš„æ™ºèƒ½åˆçº¦åŠŸèƒ½ï¼Œæ‰€ä»¥è¿™ä¸‰ä¸ªæ ‡å‡†å…¶å®ä»–ä»¬åšçš„éƒ½æ˜¯åŒæ ·çš„äº‹æƒ…ï¼Œå°±æ˜¯åˆ©ç”¨ witness å†™æ•°æ®ï¼Œç„¶åäº¤æ˜“æ‰€/é’±åŒ…/å¸‚åœºä½¿ç”¨ç´¢å¼•å™¨æ¥è¯»å–å’Œè§£é‡Šï¼Œè·Ÿè¸ªä»£å¸ä½™é¢å’Œæœ‰æ•ˆäº¤æ˜“ã€‚



> æ¯”å¦‚çœ‹è¿™ä¸ªäº¤æ˜“ï¼š
> https://mempool.space/zh/tx/44bd36d5ded0153ff3e8b89ac009b922858c71a34bd9f9d70c8cd27cf2860d11
>
> æˆ–è€…çœ‹ï¼ˆå¦‚æœæ‰“ä¸å¼€ï¼‰
>
> https://www.blockchain.com/explorer/transactions/btc/44bd36d5ded0153ff3e8b89ac009b922858c71a34bd9f9d70c8cd27cf2860d11

è¿™ç¬”äº¤æ˜“ä¸­é“­æ–‡çš„å†…å®¹åœ¨ **input çš„ witness[1]** é‡Œï¼Œæ•°æ®åœ¨è¿™é‡Œè¢«è®°å½•ã€‚

output ä¸­å¯ä»¥çœ‹åˆ°è¿™æ¯”äº¤æ˜“ç”Ÿæˆäº†ä¸€ä¸ªæ–°çš„ UTXOï¼Œè¿™ä¸ª utxo é‡‘é¢ä¸º 546 satsï¼Œåœ°å€ä¸º addressï¼Œå¹¶ä¸”æ˜¯ä¸€ä¸ª P2TRï¼ˆTaprootï¼‰é”å®šè„šæœ¬ï¼Œè¿™ä¸ª output çš„ pkscript æ˜¯ä¸€ä¸ª P2TR é”å®šäº¤æ˜“ï¼Œæ„å‘³ç€æ‹¥æœ‰å¯¹åº”ç§é’¥çš„äººæ‰å¯ä»¥æ„é€ ä¸‹ä¸€ç¬”äº¤æ˜“ï¼Œä¹Ÿå°±æ˜¯æŒæœ‰é“­æ–‡

```
"outputs": [
  {
    "address": "bc1pt8vjenyfl3na7t4qtkcjgctsdw52lmqk92gsv4mqjvnh7z83cznqk8kj5n",
    "value": 546,
    "spent": false
  }
]
```

### ç¬¬ä¸€ä¸ª BRC-20 ORDI

ç¬¬ä¸€ä¸ªé“­æ–‡ï¼š

https://ordinalswallet.com/inscription/b61b0172d95e266c18aea0c624db987e971a5d6d4ebc2aaed85da4642d635735i0

éƒ¨ç½²äº¤æ˜“ï¼š

https://mempool.space/zh/tx/b61b0172d95e266c18aea0c624db987e971a5d6d4ebc2aaed85da4642d635735

åŒæ ·çš„å°è¯•è§£æå‡ºåŸå§‹å¯è¯»å­—ç¬¦ä¸²

```
âœ echo 746578742f706c61696e3b636861727365743d7574662d38 | xxd -r -p
text/plain;charset=utf-8%                                                       
~ 
âœ echo 7b200a20202270223a20226272632d3230222c0a2020226f70223a20226465706c6f79222c0a2020227469636b223a20226f726469222c0a2020226d6178223a20223231303030303030222c0a2020226c696d223a202231303030220a7d | xxd -r -p
{ 
  "p": "brc-20",
  "op": "deploy",
  "tick": "ordi",
  "max": "21000000",
  "lim": "1000"
}% 
```

### BRC-20 çš„é“¾ä¸‹è§„åˆ™

ORDI çš„â€œå‘è¡Œâ€ä»ä¸€æ¡**çº¯æ–‡æœ¬é“­æ–‡**å¼€å§‹ã€‚è¿™æ¡é“­æ–‡å†…å®¹å¤§è‡´æ˜¯ï¼ˆJSONï¼‰ï¼š

```json
{
  "p": "brc-20",
  "op": "deploy",
  "tick": "ordi",
  "max": "21000000",
  "lim": "1000"
}
```

æ¥ä¸‹æ¥ï¼Œä»»ä½•äººéƒ½å¯ä»¥ mintã€‚mint é“­æ–‡å†…å®¹ç±»ä¼¼ï¼š

```json
{
  "p": "brc-20",
  "op": "mint",
  "tick": "ordi",
  "amt": "1000"
}
```

å½“æ‰€æœ‰çš„ mint é“­æ–‡ç´¯è®¡åˆ°ä¸Šé™ä¹‹å ORDI å°±ç®—æ˜¯å…¨éƒ¨å‘è¡Œå®Œæˆã€‚å®ƒçš„åˆ†é…æ–¹å¼å°±æ˜¯è°å…ˆä¸Šé“¾é“­åˆ»ï¼Œè°å°±èƒ½æ‹¿åˆ°ã€‚

è°æ¥è§„å®šè¿™ä¸ªä¸Šé™å‘¢ï¼Ÿæ˜¯ BRC-20 indexerï¼ˆç´¢å¼•å™¨ï¼‰ï¼Œç´¢å¼•å™¨æ˜¯ä¸€ä¸ª**é“¾ä¸‹ç¨‹åº**ï¼Œå®ƒçš„è§„åˆ™é€šå¸¸æ˜¯ï¼š

- åªè®¤æœ€æ—©çš„ deploy
- è¯»å– `max` ä½œä¸ºæ€»ä¾›åº”
- ç´¯è®¡æ‰€æœ‰ mint
- è¶…è¿‡ `max` çš„ mint ä¼šè¢« indexer ç›´æ¥å¿½ç•¥ä¸è®¡å…¥ä½™é¢

> Indexer çš„èŒè´£
>
> 1. indexer ä¼šæ‰«é“¾ï¼ˆåŒºå—/äº¤æ˜“ï¼‰
> 2. ä¼šè¯»å–äº¤æ˜“é‡Œçš„ç›¸å…³å­—æ®µï¼ˆå¯¹é“­æ–‡/BRC-20 æ¥è¯´ä¸»è¦æ˜¯ witnessï¼‰
> 3. ç„¶ååœ¨è‡ªå·±æ•°æ®åº“é‡Œå»ºç«‹é“­æ–‡ç´¢å¼•ä»¥åŠæŸåœ°å€æŒæœ‰å“ªäº›é“­æ–‡/ä½™é¢çš„çŠ¶æ€è§†å›¾
>
> æœ¬è´¨æ˜¯â€œè§£é‡Šå™¨ + çŠ¶æ€æ•°æ®åº“â€ï¼Œå®ƒæŒ‰ç…§è§„åˆ™æ¨å¯¼å‡ºç‰¹å®šé“­æ–‡æ‰€å±åœ°å€ã€‚

